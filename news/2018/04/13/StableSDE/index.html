<!doctype html> <html lang=en > <meta charset=UTF-8 > <meta name=viewport  content="width=device-width, initial-scale=1"> <meta property="og:title" content="SciML: Open Source Software for Scientific Machine Learning"> <meta property="og:description" content="Open Source Software for Scientific Machine Learning"> <meta property="og:image" content="https://sciml.ai/assets/SciMLGitHubPreview.png"> <meta property="og:url" content="https://sciml.ai"> <meta name="twitter:title" content=SciML > <meta name="twitter:description" content="Open Source Software for Scientific Machine Learning"> <meta name="twitter:image" content="https://sciml.ai/assets/SciMLGitHubPreview.png"> <meta name="twitter:card" content=summary_large_image > <!-- Favicon--> <link rel=icon  type="image/x-icon" href="assets/favicon.png" /> <!-- Bootstrap icons--> <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css" rel=stylesheet  type="text/css" /> <link rel=stylesheet  href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.1/font/bootstrap-icons.css"> <!-- Google fonts--> <link href="https://fonts.googleapis.com/css?family=Lato:300,400,700,300italic,400italic,700italic" rel=stylesheet  type="text/css" /> <!-- Core theme CSS (includes Bootstrap)--> <link href="./css/styles.css" rel=stylesheet  /> <link rel=stylesheet  href="/css/franklin.css"> <link rel=stylesheet  href="/css/styles.css"> <link rel=stylesheet  href="/css/hypertext.css"> <link rel=icon  href="/assets/favicon.png"> <script async src="https://www.googletagmanager.com/gtag/js?id=UA-90474609-2"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-90474609-2'); </script> <title> DifferentialEquations.jl 4.4: Enhanced Stability and IMEX SDE Integrators </title> <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin=anonymous ></script> <script src="https://cdn.jsdelivr.net/npm/popper.js@1.14.3/dist/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin=anonymous ></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.1.3/dist/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin=anonymous ></script> <div class=container-fluid  id=top-alert > <div class="alert alert-dark alert-dismissible mb-0" role=alert > <p class=text-center > <a href="https://form.jotform.com/222333194908053">SciMLCon 2023 at the Kennedy Space Center? Take the SciMLCon survey to give your input!</a> </p> <!-- <button type=button  class=close  data-dismiss=alert  aria-label=Close > <span aria-hidden=true >&times;</span> --> </button> </div> </div> <header> <nav class="navbar navbar-expand-lg navbar-light"> <a class=navbar-brand  href="/">Home</a> <button class=navbar-toggler  type=button  data-toggle=collapse  data-target="#navbarSupportedContent" aria-controls=navbarSupportedContent  aria-expanded=false  aria-label="Toggle navigation"> <span class=navbar-toggler-icon ></span> </button> <div class="collapse navbar-collapse" id=navbarSupportedContent > <ul class="navbar-nav mr-auto"> <li class="nav-item active"> <a class=nav-link  href="https://docs.sciml.ai/">Documentation</a> <li class=nav-item > <a class=nav-link  href="/news/">News</a> <li class=nav-item > <a class=nav-link  href="/roadmap/">Roadmap</a> <li class=nav-item > <a class=nav-link  href="/citing/">Citing</a> <li class=nav-item > <a class=nav-link  href="/showcase/">Showcase</a> <li class=nav-item > <a class=nav-link  href="/challenge/">Challenges</a> <li class=nav-item > <a class=nav-link  href="https://benchmarks.sciml.ai/">Benchmarks</a> <li class=nav-item > <a class=nav-link  href="https://github.com/SciML/">GitHub</a> <li class="nav-item dropdown"> <a class="nav-link dropdown-toggle" href="#" id=navbarDropdownMenuLink  role=button  data-toggle=dropdown  aria-haspopup=true  aria-expanded=false > Community </a> <div class=dropdown-menu  aria-labelledby=navbarDropdownMenuLink > <a class=dropdown-item  href="/community/">Community Home</a> <a class=dropdown-item  href="/governance/">Governance</a> <a class=dropdown-item  href="/dev/">Programs</a> </div> <li class=nav-item > <a class=nav-link  href="https://numfocus.org/donate-to-sciml"><i class="bi bi-heart"></i> Donate</a> </ul> </div> </nav> </header> <div class=franklin-content ><h1 id=differentialequationsjl_44_enhanced_stability_and_imex_sde_integrators ><a href="#differentialequationsjl_44_enhanced_stability_and_imex_sde_integrators" class=header-anchor >DifferentialEquations.jl 4.4: Enhanced Stability and IMEX SDE Integrators</a></h1> <p>These are features long hinted at. The <a href="https://arxiv.org/abs/1804.04344">Arxiv paper</a> is finally up and the new methods from that paper are the release. In this paper I wanted to &quot;complete&quot; the methods for additive noise and attempt to start enhancing the methods for diagonal noise SDEs. Thus while it focuses on a constrained form of noise, this is a form of noise present in a lot of models and, by using the constrained form, allows for extremely optimized methods. See the <a href="https://docs.juliadiffeq.org/latest/solvers/sde_solve">updated SDE solvers documentation</a> for details on the new methods. Here&#39;s what&#39;s up&#33;</p> <h2 id=stability-enhanced_high_order_explicit_stochastic_runge-kutta_methods_for_additivediagonal_noise ><a href="#stability-enhanced_high_order_explicit_stochastic_runge-kutta_methods_for_additivediagonal_noise" class=header-anchor >Stability-Enhanced High Order Explicit Stochastic Runge-Kutta Methods for Additive/Diagonal Noise</a></h2> <p>In the paper we formulate a global optimization problem and utilize Julia&#39;s JuMP with GPUs in order to derive coefficients for high order high stability adaptive integrators for both additive and diagonal noise stochastic differential equations &#40;yeah, there&#39;s a little bit of the signularity going on there, using numerical algorithms in Julia to derive numerical algorithms in Julia...&#41;. The resulting methods have 2x-5x larger stability regions along the drift axis &#40;see paper for details&#41;, but have even more dramatic increases in efficiency and accuracy. This has a noticable user-experience change as well since these methods are stable at extremely high choices of &#40;strong&#41; tolerance, meaning they give a lot more flexibility than before. Here&#39;s a figure showing how the new <code>SOSRA</code> method looks at high tolerances &#40;low accuracy&#41; compared to the previous methods:</p> <p><img src="https://user-images.githubusercontent.com/1814174/38661858-1f245422-3de7-11e8-8fab-1734e0dc8611.PNG" alt="SOSRA tolerance" /></p> <p>The new methods of this type are:</p> <ul> <li><p><code>SOSRA</code></p> <li><p><code>SOSRA2</code></p> <li><p><code>SOSRI</code></p> <li><p><code>SOSRI2</code></p> </ul> <p><code>SOSRA</code> and <code>SOSRI</code> are now the recommended methods for additive and diagonal noise respectively.</p> <p><img src="https://user-images.githubusercontent.com/1814174/38661859-1f3f912e-3de7-11e8-9c3d-5e6aaaf5afff.PNG" alt=Benchmarks  /></p> <h2 id=high_order_adaptive_l-stable_implicit_integrator_for_stiff_sdes_with_additive_noise ><a href="#high_order_adaptive_l-stable_implicit_integrator_for_stiff_sdes_with_additive_noise" class=header-anchor >High Order Adaptive L-Stable Implicit Integrator for Stiff SDEs with Additive Noise</a></h2> <p>In the paper, two L-stable implicit integrators for additive noise SDEs are derived. Right now we only offer an implementation for the latter, the <code>SKenCarp</code> method. On the Van Der Pol equation displayed above, the benchmarks are phenomenal for this new method:</p> <p><img src="https://user-images.githubusercontent.com/1814174/38661857-1f0700ca-3de7-11e8-8db4-55d47d23392b.PNG" alt=SKenCarp  /></p> <p>So while it&#39;s restricted in the types of problems it can solve, it can do very well in this class. In the paper we show how to translate any multiplicative or affine noise SDE into additive noise SDEs in order to better make use of this method. From testing I would make the claim that this method &quot;performs as good as implicit integrators for ODEs&quot; in the sense of reliability and almost in timing. My hope for the future is to try and replicate this strategy for diagonal noise SDEs, but it will take some time to derive exactly how such extensions can work.</p> <h2 id=sdae_handling ><a href="#sdae_handling" class=header-anchor >SDAE Handling</a></h2> <p><code>SKenCarp</code> can handle stochastic differential-algebraic equations in mass matrix form. It&#39;s a very special form which applies the constraints deterministically, meaning that while it&#39;s a stochastic equation you still have conditions like energy conservation exact at every step instead of fluctuating.</p> <h2 id=adaptive_imex_method_for_sdes ><a href="#adaptive_imex_method_for_sdes" class=header-anchor >Adaptive IMEX Method for SDEs</a></h2> <p>The <code>KenCarp</code> methods in OrdinaryDiffEq.jl are IMEX methods, meaning that you can designate that only part of your equation is implicit and leave another part explicit for more efficiency in the Newton iterations. The <code>SKenCarp</code> methods are derived from the same lineage. While there is no theoretical guarantee of their success, the paper shows numerical evidence that they can achieve strong order 1.5 &#40;and given the conditions the method satisfies, it should always converge but maybe have possible order loss to strong order 1.0 on some equations, but that would require further research&#41;. Since the method seems to work well in practice we are offering the IMEX form as part of DiffEq.</p> <h2 id=stiffness_detection_and_automatic_switching_for_sdes ><a href="#stiffness_detection_and_automatic_switching_for_sdes" class=header-anchor >Stiffness Detection and Automatic Switching for SDEs</a></h2> <p>Last time we released automatic stiffness detection and switching for SDEs. The same theory can be applied to the new integrators. <code>SOSRI2</code> and <code>SOSRA2</code> have built in maximal eigenvalue estimates and a similar strategy to the deterministic case can be employed to automatically switch between explicit and implicit solvers.</p> <h1 id=the_future_of_this_work ><a href="#the_future_of_this_work" class=header-anchor >The Future of This Work</a></h1> <p>I want to continue down this path by developing stability-enhanced explicit methods for commutative and general non-diagonal noise, along with L-stable implicit methods for these cases plus the diagonal case. I would like to get some stochastic Rosenbrock methods, along with the SROCK methods, to really flesh out the StochasticDiffEq.jl offering for stiff SDEs and offer a full benchmark analysis of the field.</p> <h1 id=in_development ><a href="#in_development" class=header-anchor >In development</a></h1> <p>Here&#39;s a quick view of the rest of our &quot;in development&quot; list:</p> <ul> <li><p>Preconditioner choices for Sundials methods</p> <li><p>Adaptivity in the MIRK BVP solvers</p> <li><p>More general Banded and sparse Jacobian support outside of Sundials</p> <li><p>IMEX methods</p> <li><p>Function input for initial conditions and time span &#40;<code>u0&#40;p,t0&#41;</code>&#41;</p> <li><p>LSODA integrator interface</p> </ul> <!-- Footer--> <footer class="footer bg-light"> <div class=container > <div class=row > <div class="col-lg-6 h-100 text-center text-lg-start my-auto"> <ul class="list-inline mb-2"> <li class=list-inline-item ><a href="/community">Contact</a> <!-- <li class=list-inline-item ><a href="#!">Terms of Use</a> <li class=list-inline-item ><a href="#!">Privacy Policy</a> --> </ul> <p class="text-muted small mb-4 mb-lg-0">Website powered by <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a> and the <a href="https://julialang.org">Julia</a> programming language. &copy; SciML 2022. All Rights Reserved.</p> <p class="text-muted small mb-4 mb-lg-0">Edit on <a href="https://github.com/SciML/sciml.ai">GitHub</a></p> </div> <div class="col-lg-6 h-100 text-center text-lg-end my-auto"> <ul class="list-inline mb-0"> <li class="list-inline-item me-4"> <a href="https://github.com/SciML"><i class="bi-github fs-3"></i></a> <li class="list-inline-item me-4"> <a href="https://twitter.com/SciML_Org"><i class="bi-twitter fs-3"></i></a> <li class=list-inline-item > <a href="https://www.linkedin.com/company/the-julia-language"><i class="bi-linkedin fs-3"></i></a> </ul> </div> </div> </div> </footer> </div>