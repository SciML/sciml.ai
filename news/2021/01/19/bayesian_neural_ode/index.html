<!doctype html> <html lang=en > <meta charset=UTF-8 > <meta name=viewport  content="width=device-width, initial-scale=1"> <meta property="og:title" content="SciML: Open Source Software for Scientific Machine Learning"> <meta property="og:description" content="Open Source Software for Scientific Machine Learning"> <meta property="og:image" content="https://sciml.ai/assets/SciMLGitHubPreview.png"> <meta property="og:url" content="https://sciml.ai"> <meta name="twitter:title" content=SciML > <meta name="twitter:description" content="Open Source Software for Scientific Machine Learning"> <meta name="twitter:image" content="https://sciml.ai/assets/SciMLGitHubPreview.png"> <meta name="twitter:card" content=summary_large_image > <!-- Favicon--> <link rel=icon  type="image/x-icon" href="assets/favicon.png" /> <!-- Bootstrap icons--> <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css" rel=stylesheet  type="text/css" /> <link rel=stylesheet  href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.1/font/bootstrap-icons.css"> <!-- Google fonts--> <link href="https://fonts.googleapis.com/css?family=Lato:300,400,700,300italic,400italic,700italic" rel=stylesheet  type="text/css" /> <!-- Core theme CSS (includes Bootstrap)--> <link href="./css/styles.css" rel=stylesheet  /> <link rel=stylesheet  href="/css/franklin.css"> <link rel=stylesheet  href="/css/styles.css"> <link rel=stylesheet  href="/css/hypertext.css"> <link rel=icon  href="/assets/favicon.png"> <script async src="https://www.googletagmanager.com/gtag/js?id=UA-90474609-2"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-90474609-2'); </script> <title>SciML Ecosystem Update: Bayesian Neural ODEs, Virtual Brownian Trees, Parallel Batching and More</title> <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin=anonymous ></script> <script src="https://cdn.jsdelivr.net/npm/popper.js@1.14.3/dist/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin=anonymous ></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.1.3/dist/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin=anonymous ></script> <div class=container-fluid  id=top-alert > <div class="alert alert-dark alert-dismissible mb-0" role=alert > <p class=text-center > <a href="https://youtu.be/yHiyJQdWBY8">Check out the latest talk: "The Continuing Advancements of Scientific Machine Learning (SciML)"</a> </p> <!-- <button type=button  class=close  data-dismiss=alert  aria-label=Close > <span aria-hidden=true >&times;</span> --> </button> </div> </div> <header> <nav class="navbar navbar-expand-lg navbar-light"> <a class=navbar-brand  href="/">Home</a> <button class=navbar-toggler  type=button  data-toggle=collapse  data-target="#navbarSupportedContent" aria-controls=navbarSupportedContent  aria-expanded=false  aria-label="Toggle navigation"> <span class=navbar-toggler-icon ></span> </button> <div class="collapse navbar-collapse" id=navbarSupportedContent > <ul class="navbar-nav mr-auto"> <li class="nav-item active"> <a class=nav-link  href="https://docs.sciml.ai/">Documentation</a> <li class=nav-item > <a class=nav-link  href="/news/">News</a> <li class=nav-item > <a class=nav-link  href="/roadmap/">Roadmap</a> <li class=nav-item > <a class=nav-link  href="/citing/">Citing</a> <li class=nav-item > <a class=nav-link  href="/showcase/">Showcase</a> <li class=nav-item > <a class=nav-link  href="https://benchmarks.sciml.ai/">Benchmarks</a> <li class=nav-item > <a class=nav-link  href="https://github.com/SciML/">GitHub</a> <li class="nav-item dropdown"> <a class="nav-link dropdown-toggle" href="#" id=navbarDropdownMenuLink  role=button  data-toggle=dropdown  aria-haspopup=true  aria-expanded=false > Community </a> <div class=dropdown-menu  aria-labelledby=navbarDropdownMenuLink > <a class=dropdown-item  href="/community/">Community Home</a> <a class=dropdown-item  href="/governance/">Governance</a> <a class=dropdown-item  href="/coc/">Code of Conduct</a> <a class=dropdown-item  href="/challenge/">Challenges</a> <a class=dropdown-item  href="/dev/">Developer Programs</a> </div> <li class=nav-item > <a class=nav-link  href="https://juliahub.com/company/contact-us-sciml"> Commercial Support </a> <li class=nav-item > <a class=nav-link  href="https://numfocus.org/donate-to-sciml"><i class="bi bi-heart"></i> Donate</a> </ul> </div> </nav> </header> <div class=franklin-content ><h1 id=sciml_ecosystem_update_bayesian_neural_odes_virtual_brownian_trees_parallel_batching_and_more ><a href="#sciml_ecosystem_update_bayesian_neural_odes_virtual_brownian_trees_parallel_batching_and_more" class=header-anchor >SciML Ecosystem Update: Bayesian Neural ODEs, Virtual Brownian Trees, Parallel Batching and More</a></h1> <p>Welcome to a new year&#33; There have been a lot of exciting developments throughout the SciML ecosystem, most focusing in this case on neural and universal differential equations, expanding their functionality and providing tools for improving their performance in the hardest cases. But there&#39;s also a good set of other releases as well, such as a very high order symplectic ODE solver and a new tool for generating fast symbolic functions. Let&#39;s check it out&#33;</p> <h2 id=bayesian_neural_odes_in_diffeqflux ><a href="#bayesian_neural_odes_in_diffeqflux" class=header-anchor >Bayesian Neural ODEs in DiffEqFlux</a></h2> <p>Following our development team&#39;s latest paper on <a href="https://arxiv.org/abs/2012.07244">Bayesian Neural ODEs</a>, DiffEqFlux comes equipped with new tutorials for demonstrating how to perform probabilistic estimation of neural network weights within differential equations. Thus you can check out our <a href="https://diffeqflux.sciml.ai/dev/examples/BayesianNODE_NUTS/">new tutorials</a> and <a href="https://diffeqflux.sciml.ai/dev/examples/BayesianNODE_SGLD/">start doing</a> automated model discovery with probabilistic estimates&#33;</p> <p><img src="https://user-images.githubusercontent.com/23134958/102398119-df940a00-4004-11eb-9cdb-eb7be8724dd3.png" alt="" /> <img src="https://user-images.githubusercontent.com/23134958/102398114-defb7380-4004-11eb-835e-84f1519648dc.png" alt="" /></p> <h2 id=automated_parallel_batching_with_ensembledistributed_and_ensemblegpuarray_with_diffeqflux ><a href="#automated_parallel_batching_with_ensembledistributed_and_ensemblegpuarray_with_diffeqflux" class=header-anchor >Automated Parallel Batching with EnsembleDistributed and EnsembleGPUArray with DiffEqFlux</a></h2> <p>The <a href="https://diffeq.sciml.ai/stable/features/ensemble/">DifferentialEquations.jl ensemble interface</a> is now fully compatible with the differentiation required for DiffEqFlux, meaning that all of the batching can be done on clusters and GPUs. This allows for parallelizing different solves to be done at the same time, which means minibatches can be split and computed in tandum, all in an automated fashion. For more information, check out the <a href="https://diffeqflux.sciml.ai/dev/examples/data_parallel/">new tutorial</a>. For example, the following is how to parallelize DiffEqFlux training across a cluster on a simple ODE:</p> <pre><code class="julia hljs"><span class=hljs-keyword >using</span> Distributed
addprocs(<span class=hljs-number >4</span>)

<span class=hljs-meta >@everywhere</span> <span class=hljs-keyword >begin</span>
  <span class=hljs-keyword >using</span> OrdinaryDiffEq, DiffEqSensitivity, Flux, DiffEqFlux
  <span class=hljs-keyword >function</span> f(u,p,t)
    <span class=hljs-number >1.01</span>u .* p
  <span class=hljs-keyword >end</span>
<span class=hljs-keyword >end</span>

pa = [<span class=hljs-number >1.0</span>]
u0 = [<span class=hljs-number >3.0</span>]
θ = [u0;pa]

<span class=hljs-keyword >function</span> model1(θ,ensemble)
  prob = ODEProblem(f, [θ[<span class=hljs-number >1</span>]], (<span class=hljs-number >0.0</span>, <span class=hljs-number >1.0</span>), [θ[<span class=hljs-number >2</span>]])

  <span class=hljs-keyword >function</span> prob_func(prob, i, repeat)
    remake(prob, u0 = <span class=hljs-number >0.5</span> .+ i/<span class=hljs-number >100</span> .* prob.u0)
  <span class=hljs-keyword >end</span>

  ensemble_prob = EnsembleProblem(prob, prob_func = prob_func)
  sim = solve(ensemble_prob, Tsit5(), ensemble, saveat = <span class=hljs-number >0.1</span>, trajectories = <span class=hljs-number >100</span>)
<span class=hljs-keyword >end</span>

cb = <span class=hljs-keyword >function</span> (θ,l) <span class=hljs-comment ># callback function to observe training</span>
  <span class=hljs-meta >@show</span> l
  <span class=hljs-literal >false</span>
<span class=hljs-keyword >end</span>

opt = ADAM(<span class=hljs-number >0.1</span>)
loss_distributed(θ) = sum(abs2,<span class=hljs-number >1.0</span>.-<span class=hljs-built_in >Array</span>(model1(θ,EnsembleDistributed())))
l1 = loss_distributed(θ)
res_distributed = DiffEqFlux.sciml_train(loss_distributed, θ, opt; cb = cb, maxiters=<span class=hljs-number >100</span>)</code></pre> <h2 id=virtual_brownian_trees_o1_memory_sde_solving_and_adjoints ><a href="#virtual_brownian_trees_o1_memory_sde_solving_and_adjoints" class=header-anchor >Virtual Brownian Trees: O&#40;1&#41; Memory SDE Solving and Adjoints</a></h2> <p>A new <code>AbstractNoiseProcess</code> type, the <code>VirturalBrownianTree</code>, has been added to the <a href="https://diffeq.sciml.ai/dev/features/noise_process/#VirtualBrownianTree">Noise Process Interface</a>. This allows one to define a stochastic differential equation &#40;or a random ordinary differential equation driven by an Ito process&#41; in such a way that:</p> <ol> <li><p>Adaptivity of the SDE solver can be used</p> <li><p>Almost no memory is required for the noise process in the forward pass or adjoint.</p> </ol> <p>To swap into this noise process, all one needs to do is use the <code>noise</code> keyword argument in the <code>SDEProblem</code>, so it&#39;s a simple switch that changes the behavior. This is useful for cases like Neural SDEs on GPUs where you may be running low on GPU memory. Big shoutout to Frank Schafer &#40;@frankschae&#41; for this feature&#33;</p> <h2 id=diffeqr_auto_installation ><a href="#diffeqr_auto_installation" class=header-anchor >diffeqr auto installation</a></h2> <p>diffeqr now has automated installation of Julia, meaning that R users can grab the CRAN package and do the following:</p> <pre><code class="R hljs">install.packages<span class=hljs-punctuation >(</span><span class=hljs-string >&quot;diffeqr&quot;</span><span class=hljs-punctuation >)</span>
library<span class=hljs-punctuation >(</span>diffeqr<span class=hljs-punctuation >)</span>
de <span class=hljs-operator >&lt;-</span> diffeqr<span class=hljs-operator >::</span>diffeq_setup<span class=hljs-punctuation >(</span><span class=hljs-punctuation >)</span>

lorenz <span class=hljs-operator >&lt;-</span> <span class=hljs-keyword >function</span> <span class=hljs-punctuation >(</span>u<span class=hljs-punctuation >,</span>p<span class=hljs-punctuation >,</span>t<span class=hljs-punctuation >)</span><span class=hljs-punctuation >{</span>
  du1 <span class=hljs-operator >=</span> p<span class=hljs-punctuation >[</span><span class=hljs-number >1</span><span class=hljs-punctuation >]</span><span class=hljs-operator >*</span><span class=hljs-punctuation >(</span>u<span class=hljs-punctuation >[</span><span class=hljs-number >2</span><span class=hljs-punctuation >]</span><span class=hljs-operator >-</span>u<span class=hljs-punctuation >[</span><span class=hljs-number >1</span><span class=hljs-punctuation >]</span><span class=hljs-punctuation >)</span>
  du2 <span class=hljs-operator >=</span> u<span class=hljs-punctuation >[</span><span class=hljs-number >1</span><span class=hljs-punctuation >]</span><span class=hljs-operator >*</span><span class=hljs-punctuation >(</span>p<span class=hljs-punctuation >[</span><span class=hljs-number >2</span><span class=hljs-punctuation >]</span><span class=hljs-operator >-</span>u<span class=hljs-punctuation >[</span><span class=hljs-number >3</span><span class=hljs-punctuation >]</span><span class=hljs-punctuation >)</span> <span class=hljs-operator >-</span> u<span class=hljs-punctuation >[</span><span class=hljs-number >2</span><span class=hljs-punctuation >]</span>
  du3 <span class=hljs-operator >=</span> u<span class=hljs-punctuation >[</span><span class=hljs-number >1</span><span class=hljs-punctuation >]</span><span class=hljs-operator >*</span>u<span class=hljs-punctuation >[</span><span class=hljs-number >2</span><span class=hljs-punctuation >]</span> <span class=hljs-operator >-</span> p<span class=hljs-punctuation >[</span><span class=hljs-number >3</span><span class=hljs-punctuation >]</span><span class=hljs-operator >*</span>u<span class=hljs-punctuation >[</span><span class=hljs-number >3</span><span class=hljs-punctuation >]</span>
  <span class=hljs-built_in >c</span><span class=hljs-punctuation >(</span>du1<span class=hljs-punctuation >,</span>du2<span class=hljs-punctuation >,</span>du3<span class=hljs-punctuation >)</span>
<span class=hljs-punctuation >}</span>
u0 <span class=hljs-operator >&lt;-</span> <span class=hljs-built_in >c</span><span class=hljs-punctuation >(</span><span class=hljs-number >1.0</span><span class=hljs-punctuation >,</span><span class=hljs-number >1.0</span><span class=hljs-punctuation >,</span><span class=hljs-number >1.0</span><span class=hljs-punctuation >)</span>
tspan <span class=hljs-operator >&lt;-</span> <span class=hljs-built_in >c</span><span class=hljs-punctuation >(</span><span class=hljs-number >0.0</span><span class=hljs-punctuation >,</span><span class=hljs-number >100.0</span><span class=hljs-punctuation >)</span>
p <span class=hljs-operator >&lt;-</span> <span class=hljs-built_in >c</span><span class=hljs-punctuation >(</span><span class=hljs-number >10.0</span><span class=hljs-punctuation >,</span><span class=hljs-number >28.0</span><span class=hljs-punctuation >,</span><span class=hljs-number >8</span><span class=hljs-operator >/</span><span class=hljs-number >3</span><span class=hljs-punctuation >)</span>
prob <span class=hljs-operator >&lt;-</span> de<span class=hljs-operator >$</span>ODEProblem<span class=hljs-punctuation >(</span>lorenz<span class=hljs-punctuation >,</span>u0<span class=hljs-punctuation >,</span>tspan<span class=hljs-punctuation >,</span>p<span class=hljs-punctuation >)</span>
fastprob <span class=hljs-operator >&lt;-</span> diffeqr<span class=hljs-operator >::</span>jitoptimize_ode<span class=hljs-punctuation >(</span>de<span class=hljs-punctuation >,</span>prob<span class=hljs-punctuation >)</span>
sol <span class=hljs-operator >&lt;-</span> de<span class=hljs-operator >$</span>solve<span class=hljs-punctuation >(</span>fastprob<span class=hljs-punctuation >,</span>de<span class=hljs-operator >$</span>Tsit5<span class=hljs-punctuation >(</span><span class=hljs-punctuation >)</span><span class=hljs-punctuation >,</span>saveat<span class=hljs-operator >=</span><span class=hljs-number >0.01</span><span class=hljs-punctuation >)</span></code></pre> <p>and it will automatically install and use Julia in the backend. This is exciting as it&#39;s the first R package to make use of this, and I&#39;m sure this R-&gt;Julia backend style will become more common now that it&#39;s fully automated.</p> <h2 id=new_ode_solver_package_irkgausslegendrejl ><a href="#new_ode_solver_package_irkgausslegendrejl" class=header-anchor >New ODE Solver Package: IRKGaussLegendre.jl</a></h2> <p>We are happy to announce <a href="https://github.com/SciML/IRKGaussLegendre.jl">IRKGaussLegendre.jl</a> as having joined the SciML family. IRKGaussLegendre.jl is an ODE solver package which implements the <code>IRKGL16</code> integrator for high precision 16th order symplectic ODE solving. It&#39;s extremely efficient at what it does at the tail end of Float64 accuracy, even more efficient than the Verner methods with increasing efficiency when dropping into arbitrary precision arithmetic, and will be a nice tool in the toolbox for people looking to do high precision solving or generate reference solutions.</p> <h2 id=new_tooling_package_runtimegeneratedfunctionsjl ><a href="#new_tooling_package_runtimegeneratedfunctionsjl" class=header-anchor >New Tooling Package: RuntimeGeneratedFunctions.jl</a></h2> <p><a href="https://github.com/SciML/RuntimeGeneratedFunctions.jl">RuntimeGeneratedFunctions.jl</a> is a very complex package for doing a simple thing: building a function at runtime with full efficiency as a normal function. This is actually quite hard because &quot;being fast&quot; means invoking the compiler, and invoking compilation at runtime means doing value-dependent staged computation. Thankfully, Chris Foster &#40;@c42f&#41; came in and saved the day, implementing a lot of key features to make this fast and world-age free. This library is now used all throughout ModelingToolkit.jl for building functions that are fully optimized and free of any world-age issues.</p> <!-- Footer--> <footer class="footer bg-light"> <div class=container > <div class=row > <div class="col-lg-6 h-100 text-center text-lg-start my-auto"> <ul class="list-inline mb-2"> <li class=list-inline-item ><a href="/community">Contact</a> <!-- <li class=list-inline-item ><a href="#!">Terms of Use</a> <li class=list-inline-item ><a href="#!">Privacy Policy</a> --> </ul> <p class="text-muted small mb-4 mb-lg-0">Website powered by <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a> and the <a href="https://julialang.org">Julia</a> programming language. &copy; SciML 2022. All Rights Reserved.</p> <p class="text-muted small mb-4 mb-lg-0">Edit on <a href="https://github.com/SciML/sciml.ai">GitHub</a></p> </div> <div class="col-lg-6 h-100 text-center text-lg-end my-auto"> <ul class="list-inline mb-0"> <li class="list-inline-item me-4"> <a href="https://github.com/SciML"><i class="bi-github fs-3"></i></a> <li class="list-inline-item me-4"> <a href="https://twitter.com/SciML_Org"><i class="bi-twitter fs-3"></i></a> <li class=list-inline-item > <a href="https://www.linkedin.com/company/the-julia-language"><i class="bi-linkedin fs-3"></i></a> </ul> </div> </div> </div> </footer> </div>